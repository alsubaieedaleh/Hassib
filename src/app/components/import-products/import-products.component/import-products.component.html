<section class="form-card upload-card">
  <div class="flex items-start justify-between gap-3 flex-wrap">
    <div>
      <h3 class="text-lg font-semibold text-slate-800">Import products</h3>
      <p class="text-sm text-slate-500">Upload an Excel sheet to populate your catalogue instantly.</p>
    </div>
  </div>

  <div class="form-field mt-4">
    <label class="form-label" for="fileInput">Select Excel file (.xlsx)</label>
    <input
      id="fileInput"
      type="file"
      accept=".xlsx"
      class="form-control"
      (change)="importFile($event)"
    />
  </div>

  <div class="form-field mt-4">
    <label class="form-label">Destination location</label>
    <select class="form-control" [value]="selectedLocationId() ?? ''" (change)="onLocationChange($event)">
      @if (!locationOptions().length) {
        <option value="">No locations available</option>
      } @else {
        @for (loc of locationOptions(); track loc.id) {
          <option [value]="loc.id">{{ loc.name }}</option>
        }
      }
    </select>
    @if (locationLoading()) {
      <p class="form-hint">Loading storage locationsâ€¦</p>
    }
    @if (locationError()) {
      <p class="form-hint error">{{ locationError() }}</p>
    }
  </div>

  <p class="form-hint mt-2">
    Expected columns: <code>barcode</code>, <code>name</code>, <code>qty</code>, <code>price</code>, <code>cost</code>
  </p>
</section>
